---
title: "EDA & Survival Analysis of the Prostate Cancer 'prostateSurvival' Dataset"
author: "George Melrose"
date: "`r Sys.Date()`"
output: 
 html_document:
    toc: true
    toc_float: true
    code_folding: hide
---

```{r setup, include=FALSE}
rm(list = ls())

knitr::opts_chunk$set(echo = TRUE,warning = FALSE, message = FALSE)

pacman::p_load(tidyverse,icd,knitr,kableExtra,finalfit,lubridate,data.table,
               janitor,flextable,survival,survminer,cmprsk,rmdHelpers, ggrepel,
               scales,RColorBrewer,GGally,randomForest, caret,DT,asaur)

data("prostateSurvival")

```

## 0 - Domain Knowledge of Prostate Cancer and the 'prostateSurvival' dataset

### References 

* **CRUK 'About Cancer', 'Prostate Cancer'** - https://www.cancerresearchuk.org/about-cancer/prostate-cancer/stages/localised-prostate-cancer

* **asaur package datasets** - https://cran.r-project.org/web/packages/asaur/asaur.pdf

* **Kaggle grandmaster tanulsingh077 Mr_KnowNothing 'Prostate Cancer: In Depth Understanding,EDA , Model'** - https://www.kaggle.com/code/tanulsingh077/prostate-cancer-in-depth-understanding-eda-model

* **Oxford Very Short Introductions: Cancer**

* **Oxford Concise Colour Medical Dictionary** 

* **"Prostate Cancer Overview" (https://www.youtube.com/watch?v=ZdU5uvyafo4) and "What You Need To Know About Prostate Cancer" (https://www.youtube.com/watch?v=u4O4yNvkpqQ)  by Dr.Matthew Cooperberg from the University of California Television Youtube Channel**. Abbreviated ***UCTV*** . 

* **US Government National Cancer Institute "Prostate Cancer Treatment (PDQ®)–Health Professional Version"** - https://www.cancer.gov/types/prostate/hp/prostate-treatment-pdq . Abbreviated ***NCI*** .

### Prostate Cancer Overview

* The 'NCI Dictionary of Cancer Terms' defines the prostate as "A gland in the male reproductive system. The prostate surrounds the part of the urethra (the tube that empties the bladder) just below the bladder, and produces a fluid that forms part of the semen."

```{r lower abdomen picture}
knitr::include_graphics("C:/Users/gam55/Documents/Prostate-Cancer-Survival-Analysis/prostate_cross_section.jpg")
```




* Prostate cancer is the abnormal growth of cells in the prostate gland. The cancer cells that metastasise to the bones or other body parts are still prostate cancer.

* In the USA, prostate cancer is one of the most common cancers and has one of the highest mortalities - 

```{r prostate cancer statistics}
knitr::include_graphics("C:/Users/gam55/Documents/Prostate-Cancer-Survival-Analysis/prostate_cancer_2022.png")
```


* Cancer cells arising in the prostate is not uncommon with aging - 

```{r prostate cancer asa  feature of aging graph}
knitr::include_graphics("C:/Users/gam55/Documents/Prostate-Cancer-Survival-Analysis/prostate_cancer_cells_w_age.png")
```

* Most men diagnosed with prostate cancer would not know they had it without screening, with most men dieing of other causes. *Aggresive* prostate cancers can spread and be lethal - these need to be found before metastasis. 

* Prostate cancer is usually slow in growing. ***Five-year survival rate is ~100% for localised cancer***. Even high men with the advanced disease usually live for years with modern treatment. 

* The median age of diagnosis is 67 years old [NCI]

* There are several ways of screening and detecting for prostate cancer: having a prostate specific antigen (PSA) blood test; digital rectal exam where a doctor feels the prostate through the rectum; prostate biopsy giving a Gleason pattern/score/grade; additional imaging like bone and CT scans; RNA and Genetic testing. 

* ***All above information, unless otherwise stated, found through Dr.Cooperberg's UCTV lectures.***

### Prostate Cancer Symptoms and Diagnosis

* **Symptoms** - Most prostate cancers are found through screening therefore prostate cancer symptoms are infrequent during diagnosis. Nonetheless, prostate tumour growth can produce symptoms of urinary obstruction: decreased urinary stream; nocturia; incomplete bladder emptying. 

  These are non-specific symptoms and can also be indicative of **Benign Prostatic Hyperplasia (BPH)** - the prostate becoming enlarged, typically in older men. This can result in obstruction of the neck of the bladder, impairing urination. The bladder dilates and increased pressure is transmitted to the kidney nephrons, impairing and damaging them [Oxford Medical Dictionary].It is rare nowadays with widespread screening however prostate cancer metastasis may have already happened with symptoms of bone pain and pathological fractures.
   
  
```{r bph image}
knitr::include_graphics("C:/Users/gam55/Documents/Prostate-Cancer-Survival-Analysis/bph_image.jpg")
```  



* **Diagnosis** - Different tests and procedures can be used to diagnose prostate cancer. A **Digital Rectal Exam (DRE)** is when a clinician inserts a finger into the rectum to feel the prostate through the rectal wall for abnormalities. 

```{r dre image}
knitr::include_graphics("C:/Users/gam55/Documents/Prostate-Cancer-Survival-Analysis/dre.jpg")
```  

**Prostate-specific antigen (PSA) test** - A test to measure the levels of PSA in the blood. PSA levels are elevated in prostate cancer but can also be elevated by stress and inflammation on the prostate - after a long bicycle ride for example.

**Prostate-specific membrane antigen (PSMA) Positron Emission Tomography (PET) scan** - An imaging procedure to help find prostate cancer cells that have spread outside of the prostate, into bone, lymph nodes, or other organs. A cell-targeting molecule linked to a radioactive substance is injected into the body and travels through the blood. It attaches to a protein called PSMA that is found on the surface of prostate cancer cells. A PET scanner detects high concentrations of the radioactive molecule and shows where the prostate cancer cells are in the body. 

**Transrectal ultrasound** - a probe approximately the size of a finger is inserted into the rectum to check the prostate. The probe ultrasound off internal tissues or organs and make echoes. The echoes form a picture of body tissues called a sonogram. Transrectal ultrasound may be used during a biopsy procedure -  transrectal ultrasound guided biopsy.

```{r transrectal ultrasound image}
knitr::include_graphics("C:/Users/gam55/Documents/Prostate-Cancer-Survival-Analysis/transrectal_ultrasound.jpg")
```  


**Transrectal magnetic resonance imaging (MRI)** - A probe that gives off radio waves is inserted into the rectum near the prostate. This helps the MRI machine make clearer pictures of the prostate and nearby tissue. A transrectal MRI is done to find out if the cancer has spread outside the prostate into nearby tissues. This procedure is also called nuclear magnetic resonance imaging (NMRI). Transrectal MRI may be used during a biopsy procedure -  transrectal MRI guided biopsy.

### Staging Prostate Cacner using the Grade Group and PSA Level

If cancer is found, it will be given a grade. The grade of the cancer describes how abnormal the cancer cells look under a microscope and how quickly the cancer is likely to spread. The grade is also called the **Gleason score**.

The prostate tissue samples are checked to see how much the tumor tissue is like the normal prostate tissue and to find the two main cell patterns. The primary pattern describes the most common tissue pattern, and the secondary pattern describes the next most common pattern. Each pattern is given a grade from 3 to 5, with grade 3 looking the most like normal prostate tissue and grade 5 looking the most abnormal. The two grades are then added to get a Gleason score.

The Gleason score can range from 6 to 10. The higher the Gleason score, the more likely the cancer will metastasise. A score of 6 is a low-grade cancer; a score of 7 is a medium-grade cancer; and a score of 8, 9, or 10 is a high-grade cancer. For example, if the most common tissue pattern is grade 3 and the secondary pattern is grade 4, it means that most of the cancer is grade 3 and less of the cancer is grade 4. The grades are added for a Gleason score of 7, and it is a medium-grade cancer. The score may be written as 3+4=7, Gleason 7/10, or combined Gleason score of 7.

* **Stage I** - Cancer is only in the prostate. The cancer is not felt during a DRE and is found by needle biopsy done for high PSA level or in a sample of tissue removed during surgery. The PSA level is less than 10 and the Grade Group is 1; OR the cancer is felt during a DRE and is found in one-half or less of one side of the prostate. The PSA level is less than 10 and the Grade Group is 1.


```{r stage 1 image}
knitr::include_graphics("C:/Users/gam55/Documents/Prostate-Cancer-Survival-Analysis/stage1.jpg")
``` 




### The asaur 'prostatesurvival' dataset

The description of the dataset from the *"Applied Survival Analysis Using R"* ***(asaur)*** package - 

"This data set contains survival times for two competing causes: time from prostate cancer diagnosis to death from prostate cancer, and time from prostate cancer diagnosis to death from other causes. 
The data set also contains information on several risk factors. The data in this data set are simulated from detailed competing risk survival curves and counts of numbers of patients per group presented in Lu-Yao et al. (2009). 

Thus, the simulated data presented here contain many of the characteristics of the original SEER-Medicare prostate cancer data used in Lu-Yao et al. (2009)."

The dataframe has 14,294 observations on the following 5 variables:

* **grade** - a factor with levels 'mode' (moderately differentiated) and 'poor' (poorly differentiated). In simplified terms, moderately differentiated tumors correspond to a Gleason score of 6-7 (intermediate risk). Poorly differentiated tumors  correspond to a Gleason score of 8–10 (high risk).

* **stage** - a factor with levels T1ab (Stage T1, clinically diagnoseed), T1c (Stage T1, diagnosed via a PSA test), and T2 (Stage T2).

* **ageGroup** - a factor with levels 66-69, 70-74, 75-79, 80+ .

* **survTime** - time from diagnosis to death or last date known alive
.
* **status** - a censoring variable, 0, (censored), 1 (death from prostate cancer), and 2 (death from other causes).











## 1 - Formatting & Initial look at Data


```{r looking at the dataset}
str(prostateSurvival)

datatable(prostateSurvival)
```
